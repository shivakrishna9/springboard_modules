!function(e){Drupal.behaviors.springboardForms={attach:function(t,a){var n=function(e){e.removeClass("valid").next("label").remove().end().parents(".success").removeClass("success").end().parents(".error").removeClass("error")};e(document).ready(function(){function t(){e("#quantity-total").empty();var t=e('input[type="radio"][name*="amount"]:checked:visible').val();"other"==t&&(t=e('input[name*="other_amount"]').val());var a=0;if(!isNaN(t))var a=e('select[name*="quantity"]').val()*t;e('select[name*="quantity"]').after('<span id="quantity-total">Total: '+Drupal.settings.fundraiser.currency.symbol+a+"</span>")}if(e('input[name*="card_number"], input[name*="card_cvv"]').attr("autocomplete","off"),e('select[name*="quantity"], input[name*="amount"], input[name*="other_amount"], input[name*="recurs_monthly"]').change(t()),e.validator.addMethod("creditcard",function(e,t){return this.optional(t)||/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/i.test(e)},"Enter a valid credit card number"),e.validator.addMethod("amount",function(e,t){return this.optional(t)||/^[0-9]*(\.\d{1,3})*(,\d{1,3})?$/i.test(e)},"Enter a valid amount"),e.validator.addMethod("zipcode",function(t,a){var n=e(':input[name*="[country]"]');return n.length&&"US"==n.val()?this.optional(a)||/(^\d{5}((-|\s)\d{4})?$)|(^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} *\d{1}[A-Z]{1}\d{1}$)/i.test(t):!0},"Enter a valid zipcode"),Drupal.settings.fundraiser.donationValidate=e(".fundraiser-donation-form").validate({onkeyup:function(t,a){if(e(t).next(".error").length){if(9===a.which&&""===t.value)return;this.element(t)}},onfocusout:function(t){var a=e(t).valid();"undefined"!=typeof validateKeyCallback&&(0==a?(validateKeyCallback.status=0,validateKeyCallback.error(t)):1==a&&(validateKeyCallback.status=1,validateKeyCallback.success(t)))},highlight:function(t){e(t).addClass("key-validate"),e(t).closest(".control-group").removeClass("success").addClass("error")},success:function(t){e(t).text("OK").addClass("valid").closest(".control-group").removeClass("error").addClass("success")}}),e(".fundraiser-donation-form :input.key-validate").bind("change keyup",function(){Drupal.settings.fundraiser.donationValidate.element("#"+e(this).attr("id"))}),e(".braintree-hosted-field").length){var a={number:!1,expirationMonth:!1,expirationYear:!1,cvv:!1};e(document).on("braintree.fieldEvent",function(t,n){var r=n.fields[n.emittedBy],i=e(r.container);a[n.emittedBy]=r.isValid,r.isValid?i.closest(".control-group").removeClass("error").addClass("success"):i.closest(".control-group").removeClass("success").addClass("error")})}var r=function(){var t=Drupal.settings.fundraiser.donationValidate.form();if(!t)return!1;if(void 0!==Drupal.braintreeInstance){if("paypal"==Drupal.settings.braintree.currentPaymentMethod||"applepay"==Drupal.settings.braintree.currentPaymentMethod){var n=e("input[name=payment_method_nonce]"),r=e('input[type="radio"][name$="[amount]"]:checked'),i=r.filter("[value=other]:visible"),o=e('input[name="submitted[donation][other_amount]"]');return n.length>0&&r.length&&(!i.length||i.length&&o.val().length)}var s=function(){var t=!0;return e.each(a,function(e,a){return 0==a?(t=!1,!1):void 0}),t};return s()}return!0},i=e(".fundraiser-donation-form #edit-submit"),o=e(".fundraiser_submit_message"),s=e("<span/>").addClass("donation-processing-spinner"),d=e("<p/>").addClass("donation-processing").text("Processing ").append(s),u=e("<div/>").addClass("donation-processing-wrapper").append(d);u.hide(),i.after(u),e(".fundraiser-donation-form").once(function(){e(".fundraiser-donation-form").on("submit.donationValidate",function(){if(r()){i.add(o).hide(),u.show();var t=e(window).scrollTop(),a=t+e(window).height(),n=u.offset().top,s=n+u.height(),d=50;if(s>a||t>n){var l=parseInt(n);s>a?l+=d:l-=d,e("html, body").animate({scrollTop:l},100)}return!0}return!1})});var l;if(Drupal.settings.fundraiser&&Drupal.settings.fundraiser.js_validation_settings)for($key in Drupal.settings.fundraiser.js_validation_settings)l=e('input[name*="'+$key+'"]'),l.length&&l.rules("add",Drupal.settings.fundraiser.js_validation_settings[$key]);var c=e('input[name*="other_amount"][type!="hidden"]');c.length&&e(c).each(function(){var t=e(this);e(this).rules("add",{required:function(t){return 0==e('input[type="radio"][name$="[amount]"]:checked').length||e('input[type="radio"][name$="[amount]"][value="other"]:visible').is(":checked")},amount:!0,min:parseFloat(Drupal.settings.fundraiserWebform.minimum_donation_amount),messages:{required:"This field is required",amount:"Enter a valid amount",min:"The amount entered is less than the minimum donation amount."},errorPlacement:function(e,a){if(t.parent().children(".field-suffix").length>0){var n=t.parent().children("label.error").detach();t.parent().children(".description").after(n)}}})}),e('input[type="radio"][name*="[amount]"]').change(function(){"other"==e(this).val()?e('input[name*="[other_amount]"]').focus():n(e('input[name*="[other_amount]"]'))}),e('input[name*="[other_amount]"]').focus(function(){e('input[type="radio"][name*="[amount]"][value="other"]').attr("checked","checked")}),e('input[type="radio"][name*="[recurring_amount]"]').change(function(){"other"==e(this).val()?e('input[name*="[recurring_other_amount]"]').focus():e('input[name*="[recurring_other_amount]"]').clearEle()}),e('input[name*="[recurring_other_amount]"]').focus(function(){e('input[type="radio"][name*="[recurring_amount]"][value="other"]').attr("checked","checked")}),e('input[name*="other_amount"]').blur(function(){var a=this.value;if(void 0==window.customValidation){if(a.length&&this.value.match(/\d/g)){if(a.match(/\./)){a=a.replace(/[^\d\.]+/g,"").replace(/\./i,"-").replace(/\./g,"").replace("-",".").match(/\d+\.\d{0,2}|\.\d{0,2}/);var n=a[0];n.match(/\.\d{2}/)||(a+=n.match(/\.\d{1}/)?"0":"00")}else a=a.replace(/[^\d]+/g,"")+".00";this.value=a,t(),e(this).valid()}}else window.customValidation(a),e(this).valid()}),jQuery.extend(jQuery.validator.messages,{required:"This field is required",remote:"Please fix this field",email:"Enter a valid email address",url:"Enter a valid URL",date:"Enter a valid date",dateISO:"Enter a valid date (ISO)",number:"Must be a number",digits:"Enter only digits",creditcard:"Enter a valid credit card number",equalTo:"Enter the same value again",accept:"Enter a value with a valid extension",maxlength:jQuery.validator.format("Enter no more than {0} characters"),minlength:jQuery.validator.format("Enter at least {0} characters"),rangelength:jQuery.validator.format("Enter a value between {0} and {1} characters long"),range:jQuery.validator.format("Enter a value between {0} and {1}"),max:jQuery.validator.format("Enter a value less than or equal to {0}"),min:jQuery.validator.format("Enter a value greater than or equal to {0}")}),e("select").each(function(){e(this).next().is("select")&&e(this).next().addClass("spacer")}),e(".close").click(function(){e(this).closest(".alert").fadeOut()})})}}}(jQuery);
